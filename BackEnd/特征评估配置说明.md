# 特征评估配置面板使用说明

## 一、面板概述

"特征评估配置"面板用于配置高级评估指标的计算参数。这些参数主要用于计算**通用化指标**（适应性、鲁棒性、可移植性、协作效率），让评估结果更加全面和准确。

## 二、配置项详细说明

### 1. 启用特征评估（开关）

**作用**：控制是否启用特征评估功能

- **开启**（推荐）：会计算基础指标和通用化指标，评估结果更全面
- **关闭**：只计算基础指标（准确率、召回率、F1值等），不计算通用化指标

**建议**：一般情况下保持开启，除非您只需要基础的准确率评估。

---

### 2. 真实正例总数（可选）

**作用**：用于计算**召回率**的准确值

**说明**：
- **召回率** = 成功识别的正确结果数 / 数据集中所有真实正确结果数
- 如果不填写，系统会默认使用测试用例总数作为真实正例总数
- 如果您的测试用例只是数据集的一部分，建议填写真实的正例总数

**示例**：
- 假设您的数据集中有 1000 个真实正确的答案
- 但您只选择了 50 个测试用例进行评估
- 那么应该填写：`1000`
- 这样召回率计算会更准确

**什么时候需要填写**：
- ✅ 测试用例是完整数据集的一部分
- ✅ 需要准确计算召回率
- ❌ 测试用例就是完整数据集（可以不填）

---

### 3. 场景类型总数（可选）

**作用**：用于计算**场景覆盖度**（适应性指标的一部分）

**说明**：
- **场景覆盖度** = 可有效适配的场景类型数 / 总测试场景类型数
- 如果不填写，系统无法计算场景覆盖度的百分比
- 场景类型是指测试用例中 `metadata.scene_type` 字段的值（如：train、non_train、unknown 等）

**示例**：
- 假设您的系统设计了 5 种场景类型：训练场景、测试场景、生产场景、异常场景、未知场景
- 测试用例中覆盖了 3 种场景类型
- 那么应该填写：`5`
- 场景覆盖度 = 3/5 = 60%

**什么时候需要填写**：
- ✅ 需要计算场景覆盖度百分比
//-----------------------------------------
- ✅ 测试用例的 metadata 中包含 `scene_type` 字段
//-----------------------------------------
- ❌ 不关心场景覆盖度（可以不填）

---

### 4. 单主体基准耗时（可选）

**作用**：用于计算**协作效率指标**中的"协同任务耗时差值"

**说明**：
- **协同任务耗时差值** = 多主体协同完成任务的总时间 - 单主体完成同一任务的时间
- 如果不填写，系统无法计算协同效率的提升或下降
- 单位：秒（s）

**示例**：
- 假设单个智能体完成某个任务需要 10 秒
- 多个智能体协作完成同样任务需要 8 秒
- 那么应该填写：`10`
- 协同任务耗时差值 = 8 - 10 = -2 秒（表示协作提升了效率）

**什么时候需要填写**：
- ✅ 测试用例中包含协作任务（`metadata.collaboration = true`）
- ✅ 需要评估协作效率
- ❌ 没有协作任务（可以不填）

---

### 5. 基准适配成本（可选）

**作用**：用于计算**可移植性指标**中的"适配成本系数"

**说明**：
- **适配成本系数** = 迁移所需人力/时间成本 / 原部署成本
- 如果不填写，系统无法计算适配成本系数，只能显示平均适配成本
- 这是一个相对值，用于比较迁移成本

**示例**：
- 假设原部署成本为 1.0（基准值）
- 迁移到新环境需要 1.5 的成本
- 那么应该填写：`1.0`
- 适配成本系数 = 1.5 / 1.0 = 1.5（表示成本增加了 50%）

**什么时候需要填写**：
- ✅ 测试用例中包含部署尝试（`metadata.deployment_attempt = true`）
- ✅ 需要评估可移植性成本
- ❌ 不关心适配成本（可以不填）

---

### 6. 评估特性（多选框）

**作用**：选择要计算的评估指标类型

**选项说明**：

#### ✅ 基础指标（必选，建议保持选中）
- **包含**：准确率、召回率、F1值、任务完成率、平均耗时
- **作用**：评估智能体的基本能力
- **建议**：始终选中

#### ✅ 适应性（可选）
- **包含**：跨场景任务完成率偏差、未知场景适配耗时、场景覆盖度
- **作用**：评估智能体在不同场景下的适应能力
- **需要**：测试用例的 metadata 中包含 `scene_type` 字段
- **建议**：如果测试用例有场景分类，建议选中

#### ✅ 鲁棒性（可选）
- **包含**：异常输入错误率、高并发稳定性、环境波动容错率
- **作用**：评估智能体在异常条件下的稳定运行能力
- **需要**：测试用例的 metadata 中包含：
  - `abnormal_input = true`（异常输入）
  - `high_concurrency = true`（高并发）
  - `environment_unstable = true`（环境不稳定）
- **建议**：如果有异常测试用例，建议选中

#### ✅ 可移植性（可选）
- **包含**：跨环境部署成功率、兼容性问题数、适配成本系数、兼容性清单覆盖率
- **作用**：评估智能体在不同环境中的部署能力
- **需要**：测试用例的 metadata 中包含：
  - `deployment_attempt = true`（部署尝试）
  - `deployment_success = true/false`（部署是否成功）
  - `compatibility_issues`（兼容性问题数）
  - `adaptation_cost`（适配成本）
- **建议**：如果有部署相关测试用例，建议选中

#### ✅ 协作效率（可选）
- **包含**：信息交互准确率、协同任务耗时差值、协同贡献度
- **作用**：评估智能体与其他智能体/人类协同完成任务的能力
- **需要**：测试用例的 metadata 中包含：
  - `collaboration = true`（协作任务）
  - `collaboration_duration`（协作耗时）
  - `contribution_ratio`（贡献度）
- **建议**：如果有协作任务测试用例，建议选中

**提示**：未选中的特性不会计算，对应的结果面板也会隐藏。

---

## 三、使用场景示例

### 场景 1：基础评估（最简单）

**配置**：
- ✅ 启用特征评估：开启
- 真实正例总数：不填（使用默认值）
- 场景类型总数：不填
- 单主体基准耗时：不填
- 基准适配成本：不填
- 评估特性：只选中"基础指标"

**结果**：只计算准确率、召回率、F1值、任务完成率、平均耗时

---

### 场景 2：完整评估（推荐）

**配置**：
- ✅ 启用特征评估：开启
- 真实正例总数：填写（如果知道）
- 场景类型总数：填写（如果知道）
- 单主体基准耗时：填写（如果有协作任务）
- 基准适配成本：填写（如果有部署任务）
- 评估特性：全部选中

**结果**：计算所有指标，包括基础指标和通用化指标

---

### 场景 3：只评估基础能力

**配置**：
- ❌ 启用特征评估：关闭

**结果**：只计算基础指标，不计算通用化指标

---

## 四、常见问题

### Q1: 这些参数必须填写吗？

**A**: 不是必须的。所有参数都是**可选**的：
- 不填写时，系统会使用默认值或跳过相关计算
- 填写后，相关指标的计算会更准确

### Q2: 每次评估都要重新填写吗？

**A**: 是的，每次评估都需要配置。但您可以：
- 保持默认值（大部分情况下可以）
- 根据不同的评估需求调整参数

### Q3: 如何知道应该填写什么值？

**A**: 
- **真实正例总数**：查看您的完整数据集大小
- **场景类型总数**：查看您设计的场景类型数量
- **单主体基准耗时**：通过实验测量单个智能体完成任务的时间
- **基准适配成本**：查看原始部署的成本记录

### Q4: 填写错误会影响评估结果吗？

**A**: 
- 填写错误会导致相关指标计算不准确
- 但不会导致评估失败
- 如果不确定，建议不填写，使用默认值

### Q5: 评估特性如何选择？

**A**: 
- **基础指标**：建议始终选中
- **其他特性**：根据测试用例的 metadata 内容选择
  - 如果测试用例有场景分类，选中"适应性"
  - 如果测试用例有异常测试，选中"鲁棒性"
  - 如果测试用例有部署测试，选中"可移植性"
  - 如果测试用例有协作测试，选中"协作效率"

---

## 五、快速开始建议

### 第一次使用（推荐配置）

1. ✅ **启用特征评估**：开启
2. **真实正例总数**：不填（使用默认值）
3. **场景类型总数**：不填
4. **单主体基准耗时**：不填
5. **基准适配成本**：不填
6. **评估特性**：全部选中

这样配置可以：
- 计算所有可用的指标
- 即使某些参数缺失，系统也会使用默认值
- 评估结果最全面

### 后续优化

根据评估结果和需求，逐步完善参数：
- 如果发现召回率不准确，填写"真实正例总数"
- 如果需要场景覆盖度，填写"场景类型总数"
- 如果有协作任务，填写"单主体基准耗时"
- 如果有部署任务，填写"基准适配成本"

---

## 六、参数与指标对应关系

| 参数 | 影响的指标 | 是否必须 |
|------|-----------|---------|
| 真实正例总数 | 召回率 | ❌ 可选 |
| 场景类型总数 | 场景覆盖度（适应性） | ❌ 可选 |
| 单主体基准耗时 | 协同任务耗时差值（协作效率） | ❌ 可选 |
| 基准适配成本 | 适配成本系数（可移植性） | ❌ 可选 |
| 评估特性选择 | 决定计算哪些指标 | ✅ 必须选择至少一个 |

---

## 七、总结

**核心要点**：
1. ✅ **启用特征评估**：建议保持开启
2. 📝 **参数填写**：都是可选的，根据需求填写
3. ☑️ **特性选择**：根据测试用例内容选择
4. 💡 **默认配置**：全部选中特性，参数不填，也能正常评估

**记住**：这些配置是为了让评估结果更准确，但即使不填写，系统也能正常工作！

